{% extends "layout.html" %}

{% block title %}Sustainability{% endblock %}

{% block page_content %}
  <!-- Article Header -->
  <header class="article-header">
    <div class="container">
      <h1>可持续发展</h1>
    </div>
  </header>

  <!-- Article Container -->
  <div class="article-container">
    <!-- Sidebar -->
    <div class="article-sidebar">
      <nav class="catalog">
        <h4 id="contents">目录</h4>
        <ul class="catalog-list">
          <li><a href="#sustainability-vision">可持续愿景</a></li>
          <li><a href="#green-research">绿色研究</a></li>
          <li><a href="#environmental-impact">环境影响</a></li>
          <li><a href="#future-commitment">未来承诺</a></li>
        </ul>
      </nav>
    </div>
    
    <!-- Article Content -->
    <article class="article-content">
      <h2 id="sustainability-vision">可持续愿景</h2>
      <p>我们致力于通过科学研究和技术创新，为全球可持续发展做出贡献，构建一个更加美好的未来。</p>
      
      <h3>核心理念</h3>
      <ul>
        <li>环境保护与生态修复</li>
        <li>绿色技术与清洁能源</li>
        <li>循环经济与资源利用</li>
        <li>社会责任与伦理科研</li>
      </ul>

      <h2 id="green-research">绿色研究</h2>
      <p>我们的研究工作始终秉承绿色可持续的原则，在实验设计和执行中最大限度地减少环境影响。</p>
      
      <h3>绿色实验室实践</h3>
      <ul>
        <li>减少化学试剂和危险物质的使用</li>
        <li>优化实验流程减少能耗</li>
        <li>实验废料的分类处理和回收</li>
        <li>采用环保材料和设备</li>
      </ul>

      <h2 id="environmental-impact">环境影响</h2>
      <p>我们的研究目标是在解决塑料污染问题的同时，最大限度地减少研究过程中的环境负担。</p>
      
      <h3>积极影响</h3>
      <ul>
        <li>塑料污染的有效治理</li>
        <li>清洁生产技术的推广</li>
        <li>绿色产业的发展促进</li>
        <li>可持续生活理念的传播</li>
      </ul>

      <h2 id="future-commitment">未来承诺</h2>
      <p>我们承诺将继续致力于可持续发展的研究和实践，为构建一个更加绿色、更加美好的世界贡献力量。</p>
      
      <p>通过我们的努力，我们希望能够为全球环境保护和可持续发展事业做出积极贡献。</p>
    </article>
  </div>

  <!-- Floating Buttons -->
  <div class="floating-buttons">
    <button type="button" class="btn-circle" id="scroll-to-top" title="Back to Top">
      <span style="font-weight: 600; font-size: 0.9rem; color: var(--color-text);">up</span>
    </button>
  </div>

  <script>
    // Enhanced scroll to top functionality with smart visibility
    const scrollToTopBtn = document.getElementById('scroll-to-top');
    
    // Scroll to top click handler
    scrollToTopBtn.addEventListener('click', function() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
    
    // Smart visibility based on scroll position with throttling
    let ticking = false;
    
    function updateScrollButtonVisibility() {
      if (window.scrollY > 300) {
        scrollToTopBtn.classList.add('show');
      } else {
        scrollToTopBtn.classList.remove('show');
      }
      ticking = false;
    }
    
    function handleScroll() {
      if (!ticking) {
        requestAnimationFrame(updateScrollButtonVisibility);
        ticking = true;
      }
    }
    
    window.addEventListener('scroll', handleScroll);



    // Auto-generate catalog based on headings
    function initPageSpecificFunctionality() {
      const catalogList = document.querySelector('.catalog-list');
      const headings = document.querySelectorAll('.article-content h2, .article-content h3');
      
      // Clear existing links
      catalogList.innerHTML = '';
      
      headings.forEach(function(heading) {
        if (heading.id) {
          const li = document.createElement('li');
          const a = document.createElement('a');
          a.href = '#' + heading.id;
          a.textContent = heading.textContent;
          a.className = heading.tagName === 'H3' ? 'sub-heading' : '';
          li.appendChild(a);
          catalogList.appendChild(li);
        }
      });
      
      // Add smooth scrolling and active state
      const catalogLinks = document.querySelectorAll('.catalog-list a');
      catalogLinks.forEach(function(link) {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const targetId = this.getAttribute('href').substring(1);
          const targetElement = document.getElementById(targetId);
          if (targetElement) {
            targetElement.scrollIntoView({ behavior: 'smooth' });
          }
        });
      });
      
      // Highlight active section on scroll
      function updateActiveSection() {
        const scrollPos = window.scrollY + 150;
        headings.forEach(function(heading) {
          const section = heading;
          const sectionTop = section.offsetTop;
          const sectionHeight = section.offsetHeight;
          const id = section.getAttribute('id');
          
          if (scrollPos >= sectionTop && scrollPos < sectionTop + sectionHeight) {
            catalogLinks.forEach(function(link) {
              link.classList.remove('active');
            });
            const activeLink = document.querySelector('.catalog-list a[href="#' + id + '"]');
            if (activeLink) {
              activeLink.classList.add('active');
            }
          }
        });
      }
      
      window.addEventListener('scroll', updateActiveSection);
      updateActiveSection();
    }
    setTimeout(initPageSpecificFunctionality, 500);
  </script>
{% endblock %}
